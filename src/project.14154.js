window.__require=function e(t,i,n){function c(s,r){if(!i[s]){if(!t[s]){var a=s.split("/");if(a=a[a.length-1],!t[a]){var u="function"==typeof __require&&__require;if(!r&&u)return u(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var h=i[s]={exports:{}};t[s][0].call(h.exports,function(e){return c(t[s][1][e]||e)},h,h.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof __require&&__require,s=0;s<n.length;s++)c(n[s]);return c}({Bird:[function(e,t,i){"use strict";cc._RF.push(t,"3ff9b3FqCVN24J+HOuQGI3q","Bird");var n=cc.Enum({Ready:-1,Rise:-1,FreeFall:-1,Drop:-1,Dead:-1});cc.Class({statics:{State:n},extends:cc.Component,properties:{initRiseSpeed:100,gravity:1e3,state:{default:n.Ready,type:n},sky:{default:null,type:cc.Node},ground:{default:null,type:cc.Node},riseAudio:{default:null,url:cc.AudioClip},dropAudio:{default:null,url:cc.AudioClip},hitAudio:{default:null,url:cc.AudioClip}},init:function(e){this.game=e,this.state=n.Ready,this.currentSpeed=0,this.anim=this.getComponent(cc.Animation),this.anim.playAdditive("birdFlapping")},startFly:function(){this._getNextPipe(),this.anim.stop("birdFlapping"),this.rise()},_getNextPipe:function(){this.nextPipe=this.game.pipeManager.getNext()},update:function(e){this.state!==n.Ready&&this.state!==n.Dead&&(this._updatePosition(e),this._updateState(e),this._detectCollision(),this._fixBirdFinalPosition())},_updatePosition:function(e){(this.state===n.Rise||this.state===n.FreeFall||this.state===n.Drop)&&(this.currentSpeed-=e*this.gravity,this.node.y+=e*this.currentSpeed)},_updateState:function(e){switch(this.state){case n.Rise:this.currentSpeed<0&&(this.state=n.FreeFall,this._runFallAction());break;case n.Drop:this._detectCollisionWithBird(this.ground)&&(this.state=n.Dead)}},_detectCollision:function(){var e=this;if(this.nextPipe&&this.state!==n.Ready&&this.state!==n.Dead&&this.state!==n.Drop){var t=!1;this._detectCollisionWithBird(this.nextPipe.topPipe)&&(t=!0),this._detectCollisionWithBird(this.nextPipe.bottomPipe)&&(t=!0);var i=!1;if(this._detectCollisionWithBird(this.ground)&&(i=!0),this._detectCollisionWithBird(this.sky)&&(t=!0),t||i)cc.audioEngine.playEffect(this.hitAudio),i?this.state=n.Dead:(this.state=n.Drop,this._runDropAction(),this.scheduleOnce(function(){cc.audioEngine.playEffect(e.dropAudio)},.3)),this.anim.stop(),this.game.gameOver();else this.node.x>this.nextPipe.node.x+this.nextPipe.topPipe.width&&(this.game.gainScore(),this._getNextPipe())}},_fixBirdFinalPosition:function(){this._detectCollisionWithBird(this.ground)&&(this.node.y=this.ground.y+this.node.width/2)},_detectCollisionWithBird:function(e){return this.node.getBoundingBoxToWorld().intersects(e.getBoundingBoxToWorld())},rise:function(){this.state=n.Rise,this.currentSpeed=this.initRiseSpeed,this._runRiseAction(),cc.audioEngine.playEffect(this.riseAudio)},_runRiseAction:function(){this.node.stopAllActions();var e=cc.rotateTo(.3,-30).easing(cc.easeCubicActionOut());this.node.runAction(e)},_runFallAction:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.6;this.node.stopAllActions();var t=cc.rotateTo(e,90).easing(cc.easeCubicActionIn());this.node.runAction(t)},_runDropAction:function(){this.currentSpeed>0&&(this.currentSpeed=0),this._runFallAction(.4)}}),cc._RF.pop()},{}],ButtonStartGame:[function(e,t,i){"use strict";cc._RF.push(t,"7d1e4bMKtJM+rfUOnDPuL5e","ButtonStartGame"),cc.Class({extends:cc.Component,properties:{swooshingAudio:{default:null,url:cc.AudioClip},maskLayer:{default:null,type:cc.Node}},startGame:function(){cc.audioEngine.playEffect(this.swooshingAudio),this.maskLayer.active=!0,this.maskLayer.opacity=0,this.maskLayer.color=cc.Color.BLACK,this.maskLayer.runAction(cc.sequence(cc.fadeIn(.2),cc.callFunc(function(){cc.director.loadScene("game")},this)))}}),cc._RF.pop()},{}],Game:[function(e,t,i){"use strict";cc._RF.push(t,"6d5a4SXkHRP15ICrxcjO41C","Game");var n=e("PipeManager"),c=e("Bird"),o=e("Scroller");cc.Class({extends:cc.Component,properties:{goldScore:30,silverScore:10,pipeManager:n,bird:c,scoreLabel:cc.Label,maskLayer:{default:null,type:cc.Node},ground:{default:null,type:cc.Node},readyMenu:{default:null,type:cc.Node},gameOverMenu:{default:null,type:cc.Node},scoreAudio:{default:null,url:cc.AudioClip},swooshingAudio:{default:null,url:cc.AudioClip}},onLoad:function(){this.score=0,this.scoreLabel.string=this.score,this.bird.init(this),this.canTouch=!0,this._registerInput(),this._revealScene()},_revealScene:function(){this.maskLayer.active=!0,this.maskLayer.color=cc.Color.BLACK,this.maskLayer.runAction(cc.fadeOut(.3))},restart:function(){cc.audioEngine.playEffect(this.swooshingAudio),this.maskLayer.color=cc.Color.BLACK,this.maskLayer.runAction(cc.sequence(cc.fadeIn(.3),cc.callFunc(function(){cc.director.loadScene("game")},this)))},_gameStart:function(){this._hideReadyMenu(),this.pipeManager.startSpawn(),this.bird.startFly()},gameOver:function(){this.pipeManager.reset(),this.ground.getComponent(o).stopScroll(),this.canTouch=!1,this._blinkOnce(),this._showGameOverMenu()},gainScore:function(){this.score++,this.scoreLabel.string=this.score,cc.audioEngine.playEffect(this.scoreAudio)},_hideReadyMenu:function(){var e=this;this.scoreLabel.node.runAction(cc.fadeIn(.3)),this.readyMenu.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){e.readyMenu.active=!1},this)))},_blinkOnce:function(){this.maskLayer.color=cc.Color.WHITE,this.maskLayer.runAction(cc.sequence(cc.fadeTo(.1,200),cc.fadeOut(.1)))},_showGameOverMenu:function(){var e=this;this.scoreLabel.node.runAction(cc.sequence(cc.fadeOut(.3),cc.callFunc(function(){e.scoreLabel.node.active=!1},this)));var t=this.gameOverMenu.getChildByName("gameOverLabel"),i=this.gameOverMenu.getChildByName("resultBoard"),n=this.gameOverMenu.getChildByName("startButton"),c=i.getChildByName("currentScore"),o=i.getChildByName("bestScore"),s=i.getChildByName("medal"),r=cc.sys.localStorage.getItem("bestScore");("null"===r||this.score>r)&&(r=this.score),cc.sys.localStorage.setItem("bestScore",r),c.getComponent(cc.Label).string=this.score,o.getComponent(cc.Label).string=r;var a=function(e,t){s.getComponent(cc.Sprite).spriteFrame=t};this.score>=this.goldScore?cc.loader.loadRes("image/medal_gold.png/medal_gold",a):this.score>=this.silverScore?cc.loader.loadRes("image/medal_silver.png/medal_silver",a):a();var u=function(t,i,c){n.active=!0,cc.audioEngine.playEffect(e.swooshingAudio),t.runAction(cc.sequence(i,cc.callFunc(function(){c&&c()},e)))};this.gameOverMenu.active=!0;this.scheduleOnce(function(){return u(t,cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,10)),cc.moveBy(.5,cc.v2(0,-10)))),function(){return u(i,cc.moveTo(.5,cc.v2(i.x,-250)).easing(cc.easeCubicActionOut()),function(){return u(n,cc.fadeIn(.5))})})},.55)},_startGameOrJumpBird:function(){this.bird.state===c.State.Ready?this._gameStart():this.bird.rise()},_registerInput:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._touchBegin,this)},_touchBegin:function(){this.canTouch&&this._startGameOrJumpBird()}}),cc._RF.pop()},{Bird:"Bird",PipeManager:"PipeManager",Scroller:"Scroller"}],PipeGroup:[function(e,t,i){"use strict";cc._RF.push(t,"86f21otUfpLj4fEQlUT5NXV","PipeGroup"),cc.Class({extends:cc.Component,properties:{topPipeMinHeight:100,bottomPipeMinHeight:100,spacingMinValue:300,spacingMaxValue:450,topPipe:cc.Node,bottomPipe:cc.Node},init:function(e){this.pipeManager=e,this._initPositionX(),this._initPositionY()},_initPositionX:function(){var e=cc.view.getVisibleSize(),t=-e.width/2,i=e.width/2;this.node.x=i+300,this.recylceX=t-Math.max(this.topPipe.width,this.bottomPipe.width)},_initPositionY:function(){var e=cc.view.getVisibleSize().height/2-this.topPipeMinHeight,t=cc.find("Canvas/ground").y+this.bottomPipeMinHeight,i=this.spacingMinValue+Math.random()*(this.spacingMaxValue-this.spacingMinValue);this.topPipe.y=e-Math.random()*(e-t-i),this.bottomPipe.y=this.topPipe.y-i,cc.log(i)},update:function(e){this.pipeManager.isRunning&&(this.node.x+=this.pipeManager.pipeMoveSpeed*e,this.node.x<this.recylceX&&this.pipeManager.recyclePipe(this))}}),cc._RF.pop()},{}],PipeManager:[function(e,t,i){"use strict";cc._RF.push(t,"698a5FNiQFCTZIR0alYwSQo","PipeManager");var n=e("PipeGroup");cc.Class({extends:cc.Component,properties:{pipePrefab:cc.Prefab,pipeMoveSpeed:-300,pipeSpacing:500},onLoad:function(){this.pipeList=[],this.pipeGroupPool=new cc.NodePool,this.isRunning=!1},createPipeGroup:function(){return this.pipeGroupPool.size()>0?this.pipeGroupPool.get():cc.instantiate(this.pipePrefab)},recoverPipeGroup:function(e){this.pipeGroupPool.put(e)},startSpawn:function(){this._spawnPipe();var e=Math.abs(this.pipeSpacing/this.pipeMoveSpeed);this.schedule(this._spawnPipe,e),this.isRunning=!0},_spawnPipe:function(){var e=this.createPipeGroup().getComponent(n);this.node.addChild(e.node),e.node.active=!0,e.init(this),this.pipeList.push(e)},recyclePipe:function(e){e.node.removeFromParent(),e.node.active=!1,this.recoverPipeGroup(e.node)},getNext:function(){return this.pipeList.shift()},reset:function(){this.unschedule(this._spawnPipe),this.pipeList=[],this.isRunning=!1}}),cc._RF.pop()},{PipeGroup:"PipeGroup"}],Scroller:[function(e,t,i){"use strict";cc._RF.push(t,"522b3wvQk1GaKLgYsEf1ymf","Scroller"),cc.Class({extends:cc.Component,properties:{speed:-300,resetX:-300},onLoad:function(){this.canScroll=!0},update:function(e){this.canScroll&&(this.node.x+=this.speed*e,this.node.x<=this.resetX&&(this.node.x-=this.resetX))},stopScroll:function(){this.canScroll=!1},startScroll:function(){this.canScroll=!0}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(e,t,i){"use strict";cc._RF.push(t,"16e9c0ghdFGxI35gD73b46r","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["use_v2.0.x_cc.Toggle_event","Bird","ButtonStartGame","Game","PipeGroup","PipeManager","Scroller"]);